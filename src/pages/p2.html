<template>
  <require from="../custom_elements/document-row.html"></require>

  <div class="row">
    <div class="col xl3">
      <label for="progressBar">
        Labeling Progress: ${progress | numberFormat:'00.'}%
      </label>
      <div class="progress" id="progressBar">
        <div class="determinate" style.bind="progressStyle"></div>
      </div>
      <div class="form-group">
        <input type="text" value.bind="filters[0].value" placeholder="Filter Titles" class="form-control" />
      </div>
      <p>
        <md-checkbox checked.bind="filters[1].value">Show finished</md-checkbox>
      </p>
      <!-- Left list  -->
      <table class="table table-striped" aurelia-table="data.bind: classes; display-data.bind: $displayData;
      current-page.bind: currentPage; page-size.bind: pageSize; total-items.bind: totalItems;
      filters.bind: filters; api.bind: tableApi">
        <thead>
          <tr>
            <th aut-sort="key: Title" style="width: 10%">Title</th>
            <th aut-sort="key: Recommendations; default: desc"># Recommendations</th>
            <th aut-sort="key: Used"># Selected</th>
          </tr>
        </thead>
        <tbody>
          <tr repeat.for="point of $displayData" aut-select="row.bind: point; mode: multiple; selected-class: highlight"
            select.delegate="rowSelected($event.detail.row['Title'])">
            <td style="width: 20px">${point["Title"]}</td>
            <td>${point["Recommendations"]}</td>
            <td>${point["Used"]}</td>
            <!-- <td as-element="document-row" title="${point['Title']}"></td> -->
            <!-- <td><md-checkbox checked.bind="point['Done']" change.delegate="statusChanged($event.target.checked)"></md-checkbox></td> -->
            <!-- <td><a href="mailto:${user.email}">${user.email}</a></td>
                <td>${user.address.street + ', ' + user.address.city}</td> -->
          </tr>
        </tbody>
      </table>
      <div class="row">
        <div class="col l9">
          <aut-pagination current-page.bind="currentPage" page-size.bind="pageSize" total-items.bind="totalItems"
            pagination-size.bind="5" boundary-links.bind="true"> </aut-pagination>
        </div>

        <div class="col l3">
          <div class="form-inline">
            <div class="form-group pull-right">
              <select value.bind="pageSize" id="pageSize" class="form-control">
                <option model.bind="5">5</option>
                <option model.bind="10">10</option>
                <option model.bind="20">20</option>
                <option model.bind="50">50</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <!-- Middle part  -->
      <table class="table table-striped" aurelia-table="data.bind: selected_documents; display-data.bind: $selectedData;
      current-page.bind: selectPage; page-size.bind: selectSize; total-items.bind: totalSelection;">
        <thead>
          <tr>
            <th aut-sort="key: Similarity; default: desc">Percent</th>
            <th aut-sort="key: Title">Title</th>
            <th aut-sort="key: Clusters">Clusters</th>
          </tr>
        </thead>
        <tbody>
          <tr repeat.for="point of $selectedData" aut-select="row.bind: point; mode: single; selected-class: highlight"
            select.delegate="selectionSelected($event.detail.row)">
            <td as-element="small-bar" percent="${point['Similarity']}" orientation="vertical"></td>
            <td>
              <div class="row selectionList">
                <strong>${point["Document"]["Title"]}</strong>
                <hr>
              </div>
              <div class="row">
                <strong>Keywords: </strong>${point["Document"]["Keywords"]}
              </div>
            </td>
            <td>
              <div
                repeat.for="cluster of selected_similarities[point['Document']['Key']] | sort: { propertyName: 'Similarity', direction: 'descending' }">
                <div class="row">
                  <div class="col s8">
                    ${cluster["Name"]}
                  </div>
                  <div class="col s4">
                    <small-bar percent="${cluster['Similarity']}" orientation="horizontal"></small-bar>
                  </div>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- <div class="row">
        <div class="col-md-9">
            <aut-pagination current-page.bind="selectPage" page-size.bind="selectSize" total-items.bind="totalSelection"
                                   pagination-size.bind="2" boundary-links.bind="true"> </aut-pagination>
        </div>

        <div class="col-md-3">
            <div class="form-inline">
                <div class="form-group pull-right">
                    <select value.bind="selectSize" id="selectSize" class="form-control">
                        <option model.bind="5">5</option>
                        <option model.bind="10">10</option>
                        <option model.bind="20">20</option>
                        <option model.bind="50">50</option>
                    </select>
                </div>
            </div>
        </div>
    </div> -->

    </div>
    <div class="row">
      <div class="row">
        <label for="searchField">
          Search:
        </label>
        <input type="text" value.bind="search_term" id="searchField" keyup.delegate="marking() & debounce">
        <strong>Search Results:</strong> ${search_results}
        <div class="collapsible-accordion">
          <ul md-collapsible="accordion: false;">
            <li id="search">
              <div class="collapsible-header"><i class="far fa-print-search"></i>Search Results</div>
              <div id="search" class="collapsible-body">
                <p repeat.for="sent of search_sentences">${sent}</p>
              </div>
            <li id="text">
            <li class="active">
              <div class="collapsible-header"><i class="far fa-book-open"></i>Fulltext</div>
              <div id="context" class="collapsible-body">${Fulltext}</div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- <select md-select="label: Select a Dataset for the Projection" value.bind="selected_dataset" change.trigger="DatasetSelected()">
    <option repeat.for="item of datasets" model.bind="item">${item}</option>
  </select>
  <select md-select="label: Select a Projection" value.bind="selected_projection" change.trigger="ProjectionSelected()">
    <option repeat.for="item of projections" model.bind="item">${item}</option>
  </select> -->

  <!-- <scatter-plot></scatter-plot> -->
  <!-- <bar-chart></bar-chart> -->
</template>