<template>
  <div class="row">
    <!-- Keyword View -->
    <div class="col m3" style="overflow: scroll; height: 100vh;">
      <h5 style="width: 100%; text-align: center;">Author Keywords</h5>
      <table>
        <thead>
          <tr>
            <th>Keyword</th>
            <th>Mapping</th>
            <th>#</th>
          </tr>
        </thead>
        <tbody>
          <tr repeat.for="keyword of keyword_list | customSort: { propertyName: 'count', direction: sort_property }"
            click.delegate="selectKeyword($index)" class="${keyword['mapping'].length > 0 ? 'finished' : ''}"
            style="cursor: pointer;">
            <td>
              ${keyword["keyword"]}
            </td>
            <td style="word-break: break-all;">
              ${keyword["mapping"]}
            </td>
            <td>${keyword["count"]}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="col m5">
      <!-- Graph View -->
      <div class="row" style="height: 60vh;">
        <span>Active Keyword: ${selected_keyword["keyword"]}</span>
        <br>
        <span>Mapping: ${selected_keyword["mapping"]}</span>
        <br>
        <span>Number of Documents: ${selected_keyword.docs.length}</span>

      </div>
      <hr>
      <!-- Document List View -->
      <div class="row" style="overflow: scroll; height: 40vh;">
        <h5 style="width: 100%; text-align: center;">Documents</h5>
        <table>
          <thead>
            <tr>
              <th>Title</th>
              <th style="cursor: pointer" click.delegate="setSortProperty('text_similarity')">Text Sim
              </th>
              <th style="cursor: pointer" click.delegate="setSortProperty('keyword_similarity')">Keyword
                Sim</th>
            </tr>
          </thead>
          <tbody>
            <tr
              repeat.for="sim of selected_similarities | customSort: { propertyName: sim_property, direction: sort_property }"
              click.delegate="selectDocument($index)"
              class="${sim.document['Unknown'] < 1 || sim.document['Done'] ? 'finished' : ''}" style="cursor: pointer;">
              <td>
                <strong>
                  ${sim.document["Title"]}
                </strong>
                <br>
                <br>
                ${sim.document["Keywords"]}
              </td>
              <td as-element="small-bar" percent="${sim.text_similarity}" orientation="vertical" xSize="20" ySize="100">
              </td>
              <td as-element="small-bar" percent="${sim.keyword_similarity}" orientation="vertical" xsize="20"
                ysize="100"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="col m4">
      <!-- Labels View -->
      <div class="row" style="overflow: scroll; height: 60vh;">
        <h5 style="width: 100%; text-align: center;">Labels</h5>
        <table>
          <thead>
            <tr>
              <th>Label</th>
              <th style="cursor: pointer" click.delegate="setLabelSortProperty('n_docs')">Count</th>
              <th style="cursor: pointer" click.delegate="setLabelSortProperty('substring_similarity')">Substring</th>
              <th style="cursor: pointer" click.delegate="setLabelSortProperty('keyword_avg_similarity')">Sim Hist</th>
            </tr>
          </thead>
          <tbody>
            <tr
              repeat.for="label_object of label_docs | customSort: { propertyName: label_sort_property, direction: 'descending' }"
              style="cursor: pointer;" click.delegate="selectLabel($index)">
              <td style="word-break: break-all;">
                ${label_object['label']}
              </td>
              <td>${label_object['n_docs']}</td>
              <td as-element="small-bar" percent="${label_object['substring_similarity']}" orientation="vertical"
                xSize="15" , ySize="60">
              </td>
              <td as-element="bar-chart" data="${label_object['keyword_similarities']}"></td>
            </tr>
          </tbody>
        </table>
      </div>
      <hr>
      <!-- Document Info View -->
      <div class="row" style="overflow: scroll; height: 40vh;">
        <h6>Title: ${selected_document["Title"]} </h6>
        <span>${selected_document["Authors"]}</span>
        <a href=${selected_document["DOI"]}>link</a>
        <br>
        <div class="collapsible-basic-use">
          <ul md-collapsible="accordion.bind: !accordion; popout: false;">
            <li>
              <div class="collapsible-header">Abstract</div>
              <div class="collapsible-body">
                <p>${selected_document["Abstract"]}</p>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>