<template>
    <md-sidenav view-model.ref="sideNav">
        <div style="overflow: scroll; height: 100vh;">
            <table>
                <thead>
                    <tr>
                        <th>Document</th>
                        <th>Unknown Author Keywords</th>
                    </tr>
                </thead>
                <tbody>
                    <tr repeat.for="document of documents | customSort: { propertyName: 'Unknown', direction: sort_property }" 
                    click.delegate="selectDocument($index)" 
                    class="${document['Unknown'] < 1 || document['Done'] ? 'finished' : ''}"
                    style="cursor: pointer;">
                        <td>
                            ${document["Title"]}#
                        </td>
                        <td>${document["Unknown"]}</td>
                    </tr>
                </tbody>
            </table>
        </div>   
    </md-sidenav>
    <div class="row">
        <div class="col m5">
            <div style="overflow: scroll; height: 95vh;">
                <table>
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th style="cursor: pointer" click.delegate="setSortProperty('text_similarity')">Text Sim</th>
                            <th style="cursor: pointer" click.delegate="setSortProperty('keyword_similarity')">Keyword Sim</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr repeat.for="sim of selected_similarities | customSort: { propertyName: sim_property, direction: sort_property }" 
                        click.delegate="selectDocument($index)" 
                        class="${sim.document['Unknown'] < 1 || sim.document['Done'] ? 'finished' : ''}"
                        style="cursor: pointer;">
                            <td>
                                <strong>
                                    ${sim.document["Title"]}
                                </strong>
                                <br>
                                <br>
                                ${sim.document["Keywords"]}
                            </td>
                            <td as-element="small-bar" percent="${sim.text_similarity}" orientation="vertical"></td>
                            <td as-element="small-bar" percent="${sim.keyword_similarity}" orientation="vertical"></td>
                        </tr>
                    </tbody>
                </table>
            </div>   
        </div>
        <div class="col m7">
            <div class="button-row">
                <a style="width: 49%;" md-sidenav-collapse="ref.bind: sideNav;" md-button md-waves>Toggle Document Overview</a>
                <button style="width: 19%;" md-button click.delegate="lastDocument()"><- Previous</button>
                <button style="width: 30%;" md-button click.delegate="nextDocument()">Done -></button>
            </div>
            <h3>Title: ${selected_document["Title"]} </h3>
            <span>${selected_document["Authors"]}</span>
            <a href=${selected_document["DOI"]}>link</a>
            <br>
            <div class="collapsible-basic-use">
                <ul md-collapsible="accordion.bind: !accordion; popout: false;">
                    <li>
                        <div class="collapsible-header">Abstract</div>
                        <div class="collapsible-body"><p>${selected_document["Abstract"]}</p></div>
                    </li>
                </ul>
            </div>
            <table>
                <thead>
                <tr>
                    <th>Author Keyword</th>
                    <th>Keyword Mapping</th>
                </tr>
                </thead>
                <tbody>
                <tr repeat.for="keyword of selected_document['Keywords']">
                    <td>${keyword}</td>
                    <td>${getMapping(keyword)}</td>
                </tr>
                </tbody>
            </table>
            <br>
                <div class="row">
                    <div class="col m6">
                        <strong>Final Keywords</strong>
                        <div md-chips="data.two-way: selected_document['Final']; autocomplete-data.bind: autocompleteData;"></div>
                    </div>
                    <div class="col m6" style="overflow: scroll; height: 50vh;">
                        <strong>All Keywords</strong>
                        <table>
                            <thead>
                            <tr>
                                <th>Add</th>
                                <th>Keyword</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr repeat.for="keyword of keyword_list">
                                <td>
                                    <button click.trigger="addKeyword(keyword['Cluster'])">Add</button>
                                </td>
                                <td>${keyword['Cluster']}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
        </div>
    </div>
</template>